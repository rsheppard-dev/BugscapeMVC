@model BugscapeMVC.Models.Company

@using BugscapeMVC.Services.Interfaces
@using BugscapeMVC.Models.Enums

@inject IFileService FileService
@inject ICompanyInfoService CompanyService

@{
    ViewData["Title"] = "Company Details";

    var members = await CompanyService.GetAllMembersAsync(Model.Id);
}

<h1 class="font-rockwell text-dark text-xl font-bold mb-4">@ViewData["Title"]</h1>

<hr class="mb-4 h-[2px] rounded bg-mid border-0" />

<div class="grid grid-cols-12 gap-4">
    <section class="col-span-12 lg:col-span-7 space-y-4">
        <div class="flex gap-4 items-center">
            @if (Model.LogoFileData is null || Model.LogoContentType is null)
            {
                @if (!string.IsNullOrEmpty(Model.Name))
                {
                    string firstCharacter = Model.Name[0].ToString().ToUpper();

                    <div class="rounded-full bg-info h-10 w-10 flex items-center justify-center font-lato text-2xl font-bold text-white">
                        @firstCharacter
                    </div>
                }
            }
            else
            {
                <img class="h-10 w-10" src="@FileService.ConvertByteArrayToFile(Model.LogoFileData, Model.LogoContentType)" alt="@Model.Name">
            }

            <h2 class="font-rockwell text-dark text-lg font-bold grow">@Model.Name</h2>

            <div>
                @if(User.IsInRole(nameof(Roles.Admin)))
                {
                    <div class="flex gap-4 items-center justify-end">
                        <a asp-action="Edit" asp-route-id="@Model.Id" title="Edit Company Information" class="bg-light hover:scale-110 transition-transform flex items-center justify-center rounded-full p-2">
                            <svg xmlns="http://www.w3.org/2000/svg" aria-hidden fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />
                            </svg>
                        </a>
                    </div>
                }
            </div>
        </div>

        <div class="prose max-w-none font-lato text-zinc-700 mb-4">@Html.Raw(Model.Description)</div>
    </section>

    <section aria-label="Project Members" class="col-span-12 lg:col-span-5 shadow-sm rounded-md bg-white px-6 py-3 flex flex-col">
        @{
            ViewBag.Title = "Team";
        }
        <partial name="_TeamMembersPartial" model="@members" />
    </section>
</div>
